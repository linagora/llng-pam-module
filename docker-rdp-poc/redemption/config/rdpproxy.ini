# WALLIX Redemption RDP Proxy Configuration
# Minimal configuration for LemonLDAP::NG PoC
#
# See: https://github.com/wallix/redemption

[globals]
# Authentication mode: passthrough uses external script
authentication_mode = passthrough

# Passthrough script location
passthrough_executable = /usr/bin/python3
passthrough_script = /etc/rdpproxy/passthrough.py

# Logging
log_level = 6
log_file = /var/log/rdpproxy/rdpproxy.log

# Process settings
pid_file = /var/run/rdpproxy/rdpproxy.pid

# Listen address
listen_address = 0.0.0.0:3389

# Enable recording
enable_session_recording = yes

[session_recording]
# Recording directory
record_path = /var/lib/llng-sessions/rdp

# Record format (wrm = WALLIX Recording Media)
record_format = wrm

# Include keyboard input in recordings
record_keyboard = yes

# Auto-create user directories
auto_create_directory = yes

# Metadata file alongside recording
write_metadata_file = yes

[video]
# Enable video conversion capability
enable_video_conversion = yes

# Video codec for conversion
video_codec = h264

# Video quality (0-51, lower = better)
video_quality = 23

[security]
# TLS settings for client connections
tls_min_version = TLSv1.2

# Certificate for proxy (self-signed for PoC)
# In production, use proper certificates
certificate_file = /etc/rdpproxy/cert.pem
private_key_file = /etc/rdpproxy/key.pem

# NLA settings
# For PoC, we disable NLA to simplify credential handling
# In production, enable NLA for better security
enable_nla = no

[client]
# Client connection timeout (seconds)
connection_timeout = 30

# Idle timeout (seconds)
idle_timeout = 3600

# Maximum session duration (seconds, 0 = unlimited)
max_session_duration = 28800

[target]
# Default target port
default_port = 3389

# Connection timeout to target (seconds)
target_connection_timeout = 30
